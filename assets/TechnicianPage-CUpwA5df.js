import{c as R,e as K,r as d,j as e,C as V,d as q}from"./index-CPs0z4DD.js";import{L as Y,M as Q,a as X,b as Z,G as ee}from"./GenericConfirmationModal-CdOsDkWD.js";import{N as te,s as H}from"./notifications-DpjyIQbu.js";import{b as ae,r as se,u as re}from"./storage-EbjkSq6s.js";import{C as le}from"./clock-BvZjhqCS.js";/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=R("CalendarCheck",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m9 16 2 2 4-4",key:"19s6y9"}]]),W={Confirmed:1,"On Site":2,"In Progress":3,Completed:4,Cancelled:5};async function ne(t,N,w){var h,y;const f=W[N]??W.Confirmed,o=await fetch(`${((y=(h=import.meta)==null?void 0:h.env)==null?void 0:y.VITE_API_BASE_URL)||"https://api-homeservice.viniela.id"}/api/v1/admin/update-booking-status`,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({form_id:t,user_id:w,status:f})}),i=await o.json().catch(()=>null);if(!o.ok){const n=(i==null?void 0:i.message)||(i==null?void 0:i.error)||`Gagal update status (status ${o.status})`;throw new Error(n)}}const E=({label:t,photoUrlOrPath:N,onUploadFile:w,disabled:f=!1})=>{const[o,i]=d.useState(!1),h=d.useMemo(()=>se(N),[N]),y=async n=>{var k;const T=(k=n.target.files)==null?void 0:k[0];if(T)try{i(!0),await w(T)}catch(v){console.error(v),alert((v==null?void 0:v.message)||"Gagal upload foto.")}finally{i(!1),n.currentTarget.value=""}};return e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:t}),e.jsxs("div",{className:"mt-1 flex items-center space-x-4",children:[e.jsx("div",{className:"w-20 h-20 rounded-lg bg-gray-100 dark:bg-slate-700 flex items-center justify-center overflow-hidden",children:o?e.jsxs("svg",{className:"animate-spin h-5 w-5 text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):h?e.jsx("img",{src:h,alt:"Preview",className:"w-full h-full object-cover"}):e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14"})})}),e.jsxs("label",{htmlFor:`file-upload-${t.replace(/\s+/g,"-")}`,className:`relative cursor-pointer bg-white dark:bg-slate-600 py-2 px-3 border border-gray-300 dark:border-slate-500 rounded-md shadow-sm text-sm leading-4 font-medium text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-slate-500 ${f?"opacity-50 cursor-not-allowed":""}`,children:[e.jsx("span",{children:h?"Ganti Foto":"Unggah Foto"}),e.jsx("input",{id:`file-upload-${t.replace(/\s+/g,"-")}`,name:"file-upload",type:"file",className:"sr-only",onChange:y,accept:"image/*",disabled:f})]})]})]})},G=({booking:t,currentTechnicianId:N,onBookingUpdateLocal:w,onRefresh:f})=>{var F,J;const o=new Date;o.setHours(0,0,0,0);const i=new Date(t.startDate);i.setHours(0,0,0,0);const h=new Date(t.endDate);h.setHours(0,0,0,0);const y=i.getTime()!==h.getTime(),n=o>=i&&o<=h,T=o.getTime()===i.getTime(),k=o.getTime()===h.getTime(),[v,P]=d.useState(!1),[A,L]=d.useState(t.note||""),[$,D]=d.useState(t.additionalCosts||0),[b,g]=d.useState(()=>(t.additionalCosts||0).toString()==="0"?"0":new Intl.NumberFormat("id-ID").format(t.additionalCosts||0)),[B,S]=d.useState(!1),{addNotification:C}=q(),_=r=>{const c=r.target.value;if(c===""){D(0),g("");return}const l=parseInt(c.replace(/\./g,""),10);isNaN(l)||(D(l),g(new Intl.NumberFormat("id-ID").format(l)))},z=()=>{b===""&&g("0")},s=async(r,c)=>{const l=t.formId??t.form_id??null;if(!l)throw new Error("form_id tidak ditemukan pada booking (cek mapping API).");await ne(Number(l),r,N);const p={...t,...c,status:r};w(p),await f()},m=async r=>{const c=new Date().toISOString();try{if(r==="On Site"){const l=H("technician_on_the_way",{...t,status:r,arrivalTime:c});C(l,"info"),await s(r,{arrivalTime:c});return}if(r==="In Progress"){await s(r,{startTime:c});return}await s(r)}catch(l){console.error(l),C((l==null?void 0:l.message)||"Gagal update status di server.","error")}},a=async(r,c)=>{const l=t.formId??t.form_id??null;if(!l)throw new Error("form_id tidak ditemukan pada booking (cek mapping API).");const p=await re(Number(l),r,c),M=p==null?void 0:p.url,O={...t,photos:{...t.photos||{},[r]:M}};w(O),await f()},j=()=>{var r;if(!((r=t.photos)!=null&&r.after)){alert("Harap unggah foto setelah pengerjaan selesai.");return}S(!0)},u=async()=>{try{const r=new Date,c=t.startTime||new Date().toISOString(),l=new Date(c),p=Math.round((r.getTime()-l.getTime())/6e4);await s("Completed",{endTime:r.toISOString(),workDurationMinutes:p>0?p:0,note:A,additionalCosts:$});const M=H("job_completed",{...t,status:"Completed"});C(M,"success"),P(!1),S(!1)}catch(r){console.error(r),C((r==null?void 0:r.message)||"Gagal menyelesaikan pekerjaan.","error")}},x=()=>{var r,c,l,p,M;if(!n&&t.status!=="Completed"&&t.status!=="Cancelled")return e.jsx("div",{className:"mt-4 pt-4 border-t dark:border-slate-700 text-center",children:e.jsx("p",{className:"font-semibold text-gray-500 dark:text-gray-400",children:"Tugas belum dimulai."})});switch(t.status){case"Confirmed":return T?e.jsx("div",{className:"mt-4 pt-4 border-t dark:border-slate-700",children:e.jsx("button",{onClick:()=>m("On Site"),className:"w-full bg-blue-500 text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-600 transition-colors",children:"Saya Sudah di Lokasi"})}):e.jsx("div",{className:"mt-4 pt-4 border-t dark:border-slate-700 text-center",children:e.jsxs("p",{className:"font-semibold text-gray-500 dark:text-gray-400",children:["Tugas dimulai pada ",i.toLocaleDateString("id-ID")]})});case"On Site":return T?e.jsxs("div",{className:"mt-4 pt-4 border-t dark:border-slate-700 space-y-4",children:[t.arrivalTime&&e.jsxs("p",{className:"text-sm text-center font-semibold text-blue-600 dark:text-blue-400",children:["Tiba pada: ",new Date(t.arrivalTime).toLocaleTimeString("id-ID")]}),e.jsx(E,{label:"Foto Tiba di Lokasi",photoUrlOrPath:(r=t.photos)==null?void 0:r.arrival,onUploadFile:O=>a("arrival",O)}),((c=t.photos)==null?void 0:c.arrival)&&e.jsx(E,{label:"Foto Sebelum Pengerjaan",photoUrlOrPath:(l=t.photos)==null?void 0:l.before,onUploadFile:O=>a("before",O)}),e.jsx("button",{onClick:()=>m("In Progress"),disabled:!((p=t.photos)!=null&&p.arrival)||!((M=t.photos)!=null&&M.before),className:"w-full bg-yellow-500 text-white font-bold py-2 px-4 rounded-lg hover:bg-yellow-600 transition-colors disabled:bg-gray-400",children:"Mulai Pekerjaan"})]}):e.jsx("div",{className:"mt-4 pt-4 border-t dark:border-slate-700 text-center",children:e.jsx("p",{className:"font-semibold text-gray-500 dark:text-gray-400",children:"Menunggu hari pertama dimulai."})});case"In Progress":return e.jsxs("div",{className:"mt-4 pt-4 border-t dark:border-slate-700 space-y-4",children:[t.startTime&&e.jsxs("p",{className:"text-sm text-center font-semibold text-yellow-600 dark:text-yellow-400",children:["Mulai pada: ",new Date(t.startTime).toLocaleTimeString("id-ID")]}),k?e.jsx("button",{onClick:()=>P(!0),className:"w-full bg-green-500 text-white font-bold py-2 px-4 rounded-lg hover:bg-green-600 transition-colors",children:"Selesaikan Pekerjaan"}):e.jsx("p",{className:"font-semibold text-yellow-600 dark:text-yellow-400 text-center",children:"Pekerjaan Sedang Berlangsung"})]});case"Completed":return e.jsx("div",{className:"mt-4 pt-4 border-t dark:border-slate-700 text-center",children:e.jsx("p",{className:"font-semibold text-green-600 dark:text-green-400",children:"Pekerjaan Selesai"})});case"Cancelled":return e.jsx("div",{className:"mt-4 pt-4 border-t dark:border-slate-700 text-center",children:e.jsx("p",{className:"font-semibold text-red-600 dark:text-red-400",children:"Dibatalkan"})});default:return null}},I=()=>{const r=i.toLocaleDateString("id-ID",{weekday:"long",day:"numeric",month:"long"});if(!y)return`${r} - ${t.time}`;const c=h.toLocaleDateString("id-ID",{weekday:"long",day:"numeric",month:"long"});return`${r} s/d ${c}`};return e.jsxs("div",{className:`bg-white dark:bg-slate-800 shadow-lg rounded-xl overflow-hidden border-l-4 ${n?"border-primary":"border-transparent"}`,"data-aos":"fade-up",children:[e.jsxs("div",{className:"p-5",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:t.service}),e.jsx("p",{className:"font-bold text-lg text-gray-800 dark:text-white",children:t.name})]}),n&&e.jsx("span",{className:"text-xs font-bold bg-primary text-white px-2 py-1 rounded-full",children:"AKTIF HARI INI"})]}),e.jsxs("div",{className:"mt-4 space-y-2 text-sm text-secondary dark:text-slate-300",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Jadwal:"})," ",I()]}),e.jsxs("div",{children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Alamat:"})," ",t.address]}),e.jsxs("a",{href:`https://www.google.com/maps/dir/?api=1&destination=${t.lat},${t.lng}`,target:"_blank",rel:"noopener noreferrer",className:"mt-2 inline-flex items-center gap-2 bg-blue-100 text-blue-800 dark:bg-blue-900/50 dark:text-blue-300 font-semibold text-xs px-3 py-1.5 rounded-full hover:bg-blue-200 dark:hover:bg-blue-800 transition-colors",children:[e.jsx(te,{size:14}),"Dapatkan Arah"]})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Telepon:"})," ",t.whatsapp]}),(t.arrivalTime||t.startTime||t.endTime)&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200 dark:border-slate-700/50",children:[e.jsx("h4",{className:"font-semibold text-gray-700 dark:text-gray-200 mb-1",children:"Log Waktu Pengerjaan"}),t.arrivalTime&&e.jsxs("p",{children:[e.jsx("strong",{children:"Tiba di Lokasi:"})," ",new Date(t.arrivalTime).toLocaleString("id-ID",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"})]}),t.startTime&&e.jsxs("p",{children:[e.jsx("strong",{children:"Mulai Kerja:"})," ",new Date(t.startTime).toLocaleString("id-ID",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"})]}),t.endTime&&e.jsxs("p",{children:[e.jsx("strong",{children:"Selesai Kerja:"})," ",new Date(t.endTime).toLocaleString("id-ID",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"})]}),t.workDurationMinutes!=null&&e.jsxs("p",{children:[e.jsx("strong",{children:"Total Durasi Kerja:"})," ",t.workDurationMinutes," menit"]})]})]}),v?e.jsxs("div",{className:"mt-4 pt-4 border-t dark:border-slate-700 space-y-4",children:[e.jsx("h4",{className:"font-bold text-center",children:"Formulir Penyelesaian"}),e.jsx(E,{label:"Foto Setelah Selesai",photoUrlOrPath:(F=t.photos)==null?void 0:F.after,onUploadFile:r=>a("after",r)}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:`notes-${t.id}`,className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Catatan Pekerjaan Tambahan"}),e.jsx("textarea",{id:`notes-${t.id}`,rows:3,value:A,onChange:r=>L(r.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm dark:bg-slate-700 dark:border-slate-600 focus:border-primary focus:ring-primary sm:text-sm",placeholder:"Catatan tambahan..."})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:`costs-${t.id}`,className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Biaya Tambahan (Bahan, dll.)"}),e.jsxs("div",{className:"relative mt-1 rounded-md shadow-sm",children:[e.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:e.jsx("span",{className:"text-gray-500 sm:text-sm",children:"Rp"})}),e.jsx("input",{type:"text",inputMode:"numeric",id:`costs-${t.id}`,value:b,onChange:_,onBlur:z,className:"block w-full rounded-md border-gray-300 pl-8 pr-2 dark:bg-slate-700 dark:border-slate-600 focus:border-primary focus:ring-primary sm:text-sm",placeholder:"0"})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsx("button",{onClick:()=>P(!1),className:"w-full bg-gray-300 text-gray-800 font-bold py-2 px-4 rounded-lg hover:bg-gray-400 transition-colors",children:"Batal"}),e.jsx("button",{onClick:j,disabled:!((J=t.photos)!=null&&J.after),className:"w-full bg-primary text-white font-bold py-2 px-4 rounded-lg hover:bg-primary-dark transition-colors disabled:bg-gray-400",children:"Konfirmasi Selesai"})]})]}):x()]}),e.jsx(ee,{isOpen:B,onClose:()=>S(!1),onConfirm:u,title:"Konfirmasi Penyelesaian",confirmText:"Ya, Selesaikan",confirmButtonClass:"bg-green-600 hover:bg-green-700 focus:ring-green-500",children:e.jsx("p",{children:"Apakah Anda yakin ingin menyelesaikan pekerjaan ini? Pastikan data dan foto sudah benar."})})]})},xe=()=>{const{currentUser:t,logout:N}=K(),[w,f]=d.useState([]),[o,i]=d.useState("dashboard"),[h,y]=d.useState(!1),[n,T]=d.useState(null),[k,v]=d.useState("upcoming"),[P,A]=d.useState(!1),L=async()=>{A(!0);try{const s=await ae();f(s)}catch(s){console.error(s)}finally{A(!1)}};d.useEffect(()=>{const s=()=>L();return window.addEventListener("focus",s),s(),()=>window.removeEventListener("focus",s)},[]);const $=d.useMemo(()=>t?w.filter(s=>s.technician===t.name).sort((s,m)=>new Date(s.startDate).getTime()-new Date(m.startDate).getTime()):[],[t,w]),{completedJobs:D,upcomingJobsCategorized:b,upcomingJobsFlat:g}=d.useMemo(()=>{const s=$.filter(x=>x.status!=="Completed"&&x.status!=="Cancelled"),m=$.filter(x=>x.status==="Completed"||x.status==="Cancelled"),a=new Date;a.setHours(0,0,0,0);const j=new Date(a);j.setDate(a.getDate()+1);const u={today:[],tomorrow:[],upcoming:[]};return s.forEach(x=>{const I=new Date(x.startDate);I.setHours(0,0,0,0);const F=new Date(x.endDate);F.setHours(0,0,0,0),I.getTime()===a.getTime()||a>I&&a<=F?u.today.push(x):I.getTime()===j.getTime()?u.tomorrow.push(x):I.getTime()>j.getTime()&&u.upcoming.push(x)}),{completedJobs:m,upcomingJobsCategorized:u,upcomingJobsFlat:s}},[$]);d.useEffect(()=>{o==="map"&&g.length>0&&!n&&T({lat:g[0].lat,lng:g[0].lng,title:g[0].name})},[o,g,n]);const B=s=>{f(m=>m.map(a=>a.id===s.id?s:a))},S=d.useMemo(()=>{const s=new Date,m=new Date(s);m.setDate(s.getDate()-s.getDay()),m.setHours(0,0,0,0);const a=new Date(m);a.setDate(m.getDate()+6),a.setHours(23,59,59,999);const j=g.filter(u=>{const x=new Date(u.startDate);return x>=m&&x<=a});return{today:b.today.length,thisWeek:j.length,completed:D.length}},[b.today,g,D]);if(!t)return e.jsx("div",{className:"text-center py-20",children:"Loading..."});const C=t==null?void 0:t.id;if(!C)return e.jsx("div",{className:"text-center py-20",children:"currentUser.id tidak ada. Pastikan endpoint auth/me mengembalikan id user."});const _={dashboard:"Dashboard",jobs:"Tugas Saya",map:"Peta Tugas"},z=()=>{switch(o){case"dashboard":return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-white dark:bg-slate-800 p-6 rounded-2xl shadow-lg flex items-center gap-4",children:[e.jsx("div",{className:"bg-primary-light p-3 rounded-full",children:e.jsx(U,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Tugas Hari Ini"}),e.jsx("p",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:S.today})]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 p-6 rounded-2xl shadow-lg flex items-center gap-4",children:[e.jsx("div",{className:"bg-primary-light p-3 rounded-full",children:e.jsx(le,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Tugas Minggu Ini"}),e.jsx("p",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:S.thisWeek})]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 p-6 rounded-2xl shadow-lg flex items-center gap-4",children:[e.jsx("div",{className:"bg-primary-light p-3 rounded-full",children:e.jsx(V,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Total Tugas Selesai"}),e.jsx("p",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:S.completed})]})]})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold font-poppins text-gray-800 dark:text-white mb-4",children:"Jadwal Hari Ini"}),P?e.jsx("div",{className:"text-center py-10 bg-white dark:bg-slate-800 rounded-xl shadow-md",children:e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Memuat data..."})}):b.today.length>0?e.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-lg divide-y dark:divide-slate-700",children:b.today.map(a=>e.jsxs("div",{className:"p-4 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-800 dark:text-white",children:a.name}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:a.service})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-bold text-primary",children:a.time}),e.jsx("p",{className:"text-xs text-gray-400",children:a.status})]})]},a.id))}):e.jsx("div",{className:"text-center py-10 bg-white dark:bg-slate-800 rounded-xl shadow-md",children:e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Tidak ada jadwal untuk hari ini."})})]})]},"dashboard");case"jobs":const s={"Hari Ini":b.today,Besok:b.tomorrow,"Akan Datang":b.upcoming},m=Object.values(s).every(a=>a.length===0);return e.jsxs("div",{children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"inline-flex rounded-md shadow-sm bg-white dark:bg-slate-800 p-1",children:[e.jsx("button",{onClick:()=>v("upcoming"),className:`px-4 py-2 text-sm font-medium rounded-md transition-colors ${k==="upcoming"?"bg-primary text-white":"text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-slate-700"}`,children:"Akan Datang"}),e.jsx("button",{onClick:()=>v("completed"),className:`px-4 py-2 text-sm font-medium rounded-md transition-colors ${k==="completed"?"bg-primary text-white":"text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-slate-700"}`,children:"Riwayat"})]}),e.jsx("button",{onClick:L,className:"ml-3 px-4 py-2 text-sm font-semibold rounded-md bg-white dark:bg-slate-800 border border-gray-200 dark:border-slate-700 hover:bg-gray-50 dark:hover:bg-slate-700",children:"Refresh"})]}),k==="upcoming"&&(m?e.jsx("div",{className:"text-center py-20 bg-white dark:bg-slate-800 rounded-xl shadow-md","data-aos":"zoom-in",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Tidak Ada Tugas Akan Datang"})}):e.jsx("div",{className:"space-y-10",children:Object.entries(s).map(([a,j])=>j.length>0&&e.jsxs("div",{"data-aos":"fade-up",children:[e.jsx("h3",{className:"text-xl font-bold font-poppins text-gray-800 dark:text-white mb-4",children:a}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:j.map(u=>e.jsx(G,{booking:u,currentTechnicianId:C,onBookingUpdateLocal:B,onRefresh:L},u.id))})]},a))})),k==="completed"&&(D.length>0?e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:D.map(a=>e.jsx(G,{booking:a,currentTechnicianId:C,onBookingUpdateLocal:B,onRefresh:L},a.id))}):e.jsx("div",{className:"text-center py-20 bg-white dark:bg-slate-800 rounded-xl shadow-md","data-aos":"zoom-in",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Belum Ada Riwayat Tugas"})}))]},"jobs");case"map":return e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 h-[600px]","data-aos":"fade-up",children:[e.jsx("div",{className:"lg:col-span-1 bg-white dark:bg-slate-800 shadow-xl rounded-2xl p-4 space-y-3 h-full overflow-y-auto",children:g.length>0?g.map(a=>e.jsx("div",{className:`w-full p-4 rounded-lg transition-all duration-200 border-l-4 ${(n==null?void 0:n.title)===a.name?"bg-primary-light dark:bg-slate-700 border-primary":"bg-transparent"}`,children:e.jsxs("button",{onClick:()=>T({lat:a.lat,lng:a.lng,title:a.name}),className:"w-full text-left",children:[e.jsx("p",{className:"font-bold text-gray-800 dark:text-white",children:a.name}),e.jsxs("div",{className:"text-sm font-semibold text-primary mt-1",children:[new Date(a.startDate).toLocaleDateString("id-ID",{day:"numeric",month:"long"})," ","- ",a.time]})]})},a.id)):e.jsx("div",{className:"text-center py-10 text-gray-500 dark:text-gray-400",children:e.jsx("p",{children:"Tidak ada pekerjaan akan datang."})})}),e.jsx("div",{className:"lg:col-span-2 bg-white dark:bg-slate-800 shadow-xl rounded-2xl overflow-hidden h-full flex flex-col",children:n?e.jsx("iframe",{title:"Job Location Map",className:"w-full h-full border-0",src:`https://maps.google.com/maps?q=${n.lat},${n.lng}&t=&z=15&ie=UTF8&iwloc=&output=embed`,allowFullScreen:!1,loading:"lazy"},`${n.lat}-${n.lng}`):e.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-center text-center text-gray-500 dark:text-gray-400 p-6",children:[e.jsx(Z,{size:48,className:"mb-4 text-gray-300 dark:text-gray-600"}),e.jsx("h3",{className:"font-bold text-xl",children:"Peta Lokasi Tugas"}),e.jsx("p",{children:"Tidak ada tugas akan datang untuk ditampilkan."})]})})]},"map");default:return null}};return e.jsxs("div",{className:"bg-light-bg dark:bg-slate-900 min-h-screen",children:[e.jsxs("div",{className:"flex",children:[e.jsxs("aside",{className:`fixed lg:relative lg:translate-x-0 inset-y-0 left-0 z-50 w-64 bg-white dark:bg-slate-800 shadow-lg transition-transform duration-300 ease-in-out ${h?"translate-x-0":"-translate-x-full"}`,children:[e.jsx("div",{className:"flex items-center justify-center p-6 border-b dark:border-slate-700 h-20",children:e.jsx("span",{className:"text-2xl font-bold text-gray-800 dark:text-gray-100 font-poppins",children:"Teknisi"})}),e.jsx("nav",{className:"flex-grow p-4 space-y-2",children:[{name:"Dashboard",icon:Y,section:"dashboard"},{name:"Tugas Saya",icon:U,section:"jobs"},{name:"Peta Tugas",icon:Q,section:"map"}].map(s=>e.jsxs("button",{onClick:()=>{i(s.section),y(!1)},className:`w-full flex items-center gap-3 px-4 py-3 rounded-lg text-base font-semibold transition-colors ${o===s.section?"bg-primary-light text-primary dark:bg-slate-700":"text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-slate-700/50"}`,children:[e.jsx(s.icon,{size:20}),s.name]},s.section))}),e.jsx("div",{className:"p-4 border-t dark:border-slate-700",children:e.jsxs("button",{onClick:N,className:"w-full flex items-center gap-3 px-4 py-3 rounded-lg text-base font-semibold text-red-500 hover:bg-red-50 dark:hover:bg-red-900/50",children:[e.jsx(X,{size:20}),"Logout"]})})]}),e.jsxs("div",{className:"flex-1 w-full lg:w-auto",children:[e.jsxs("header",{className:"sticky top-0 z-40 bg-white/80 dark:bg-slate-900/80 backdrop-blur-sm shadow-sm h-20 flex items-center justify-between lg:justify-end px-6",children:[e.jsx("button",{onClick:()=>y(!0),className:"lg:hidden p-2 text-gray-600 dark:text-gray-300",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 12h16M4 18h16"})})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"font-semibold text-gray-700 dark:text-gray-200",children:["Hello, ",t==null?void 0:t.name]}),e.jsx("div",{className:"w-10 h-10 rounded-full bg-primary-light dark:bg-slate-700 flex items-center justify-center text-primary font-bold text-lg",children:t==null?void 0:t.name.charAt(0)})]})]}),e.jsxs("main",{className:"p-6",children:[e.jsx("h1",{className:"text-3xl font-bold font-poppins text-gray-800 dark:text-white mb-6",children:_[o]}),z()]})]})]}),h&&e.jsx("div",{onClick:()=>y(!1),className:"fixed inset-0 bg-black/50 z-40 lg:hidden"})]})};export{xe as default};
