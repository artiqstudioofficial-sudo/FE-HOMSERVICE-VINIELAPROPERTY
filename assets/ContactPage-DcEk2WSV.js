import{c as te,r as i,j as e,u as ze,b as _e,d as Oe,I as Re,R as Ke}from"./index-C_huCKJT.js";import{C as Be}from"./Calendar-ek3HiBe_.js";import{f as Ue,a as We}from"./admin-DdTG2enl.js";import{s as qe}from"./notifications-D5TRqq6t.js";import{g as Ve,a as He,f as z}from"./storage-T1dmeGhE.js";/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qe=te("Navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=te("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ye=te("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),Ze=({isOpen:N,onClose:y,bookingDetails:g})=>(i.useEffect(()=>{const m=u=>{u.key==="Escape"&&y()};return window.addEventListener("keydown",m),()=>{window.removeEventListener("keydown",m)}},[y]),N?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-50 flex justify-center items-center p-4 transition-opacity duration-300","aria-modal":"true",role:"dialog",onClick:y,children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-2xl p-8 max-w-md w-full text-center transform transition-all scale-95 duration-300","data-aos":"zoom-in","data-aos-duration":"400",onClick:m=>m.stopPropagation(),children:[e.jsx("div",{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-green-100 mb-4",children:e.jsx("svg",{className:"h-10 w-10 text-green-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})}),e.jsx("h3",{className:"text-2xl font-bold font-poppins text-gray-800 dark:text-white",children:"Pesanan Diterima!"}),e.jsxs("p",{className:"text-secondary dark:text-slate-300 mt-2 mb-6",children:["Terima kasih, ",e.jsx("span",{className:"font-semibold text-gray-800 dark:text-white",children:g.name}),". Pesanan Anda telah berhasil kami catat."]}),e.jsxs("div",{className:"bg-light-bg dark:bg-slate-700 p-4 rounded-lg text-left space-y-2 border border-gray-200 dark:border-gray-600 text-gray-800 dark:text-white",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Layanan:"})," ",g.service]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Jadwal:"})," ",g.schedule]}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 pt-2",children:"Kami akan segera menghubungi Anda melalui WhatsApp untuk konfirmasi lebih lanjut."})]}),e.jsx("button",{onClick:y,className:"mt-8 w-full bg-primary text-white font-bold px-8 py-3 rounded-lg hover:bg-primary-dark transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-opacity-50",children:"Tutup"})]})}):null),Je=()=>e.jsxs("div",{className:"relative bg-dark-bg",children:[e.jsx("div",{className:"absolute inset-0",children:e.jsx("img",{loading:"lazy",src:"https://images.unsplash.com/photo-1587560699334-cc426240169f?q=80&w=2070&auto=format&fit=crop",alt:"Pesan Layanan",className:"w-full h-full object-cover opacity-30 dark:opacity-40"})}),e.jsxs("div",{className:"relative container mx-auto px-6 py-32 text-center text-white",children:[e.jsx("h1",{className:"text-4xl md:text-5xl font-bold font-poppins leading-tight","data-aos":"fade-up",children:"Pesan Layanan Profesional Dengan Mudah"}),e.jsx("p",{className:"text-lg max-w-2xl mx-auto text-gray-300 mt-4","data-aos":"fade-up","data-aos-delay":"100",children:"Hanya beberapa langkah untuk menjadwalkan teknisi ahli kami. Isi formulir di bawah ini dan biarkan kami yang mengurus sisanya."})]})]}),Xe=({currentStep:N})=>{const y=["Info Kontak","Layanan","Jadwal","Konfirmasi"];return e.jsx("div",{className:"flex items-start justify-center mb-10 px-4","aria-label":"Progress",children:y.map((g,m)=>{const u=m+1,s=N>u,x=N===u;return e.jsxs(Ke.Fragment,{children:[e.jsxs("div",{className:"flex flex-col items-center text-center w-20",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center border-2 transition-all duration-300 ${s?"bg-primary border-primary text-white":x?"border-primary text-primary":"border-gray-300 dark:border-gray-600 text-gray-400"}`,children:s?e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}):e.jsx("span",{className:`font-bold ${x?"text-primary":"text-gray-400"}`,children:u})}),e.jsx("p",{className:`mt-2 text-xs font-semibold break-words ${x||s?"text-gray-800 dark:text-white":"text-gray-400"}`,children:g})]}),m<y.length-1&&e.jsx("div",{className:`flex-1 h-0.5 mt-5 transition-colors duration-300 ${s?"bg-primary":"bg-gray-200 dark:bg-gray-700"}`})]},g)})})};function Ne(N){var g,m;return(m=(g=window.google)==null?void 0:g.maps)!=null&&m.Geocoder?Promise.resolve(!0):document.querySelector('script[data-gmaps="1"]')?new Promise(u=>{const s=setInterval(()=>{var x,l;(l=(x=window.google)==null?void 0:x.maps)!=null&&l.Geocoder&&(clearInterval(s),u(!0))},100);setTimeout(()=>{var x,l;clearInterval(s),u(!!((l=(x=window.google)==null?void 0:x.maps)!=null&&l.Geocoder))},12e3)}):new Promise(u=>{const s=document.createElement("script");s.src=`https://maps.googleapis.com/maps/api/js?key=${encodeURIComponent(N)}&libraries=places`,s.async=!0,s.defer=!0,s.dataset.gmaps="1",s.onload=()=>{var x,l;return u(!!((l=(x=window.google)==null?void 0:x.maps)!=null&&l.Geocoder))},s.onerror=()=>u(!1),document.head.appendChild(s)})}const ea=()=>{const[N]=ze(),y=_e(),g=N.get("service")||"",[m,u]=i.useState(1),[s,x]=i.useState({name:"",whatsapp:"",address:"",service:"",startDate:null,endDate:null,time:""}),[l,P]=i.useState(null),[A,M]=i.useState(!1),[_,L]=i.useState(""),[ve,I]=i.useState(!1),[se,re]=i.useState(""),[ne,Se]=i.useState(""),[G,ie]=i.useState(!1),[O,k]=i.useState(""),[h,j]=i.useState({}),[R,oe]=i.useState(!1),[De,le]=i.useState(!1),{addNotification:E}=Oe(),[de,K]=i.useState(new Set),[Le,B]=i.useState({}),[C,U]=i.useState(1),[ce,me]=i.useState(null),[Ee,ue]=i.useState(!1),[W,xe]=i.useState([]),[q,ge]=i.useState(null),[Ce,he]=i.useState(!1),pe="AIzaSyDaNrspVq4phMSTDrNS2JSLS-pBGPU8WuQ",[ye,V]=i.useState(!1),[be,fe]=i.useState(null);i.useEffect(()=>{let t=!0;return(async()=>{const a=await Ne(pe);t&&(a?(V(!0),fe(null)):(V(!1),fe("Google Maps JS gagal dimuat. Cek internet, adblock, atau API key restriction.")))})(),()=>{t=!1}},[]),i.useEffect(()=>{(async()=>{try{he(!0),ge(null);const a=await Ue(),r={};a.forEach(d=>{const c=d.category||"Lainnya";r[c]||(r[c]=[]),r[c].push(d)});const n=Object.entries(r).map(([d,c])=>({category:d,services:c}));if(xe(n),g){const d=a.find(c=>c.name.toLowerCase()===g.toLowerCase().trim());d&&x(c=>({...c,service:String(d.id)}))}}catch(a){console.error("Gagal memuat layanan dari API:",a),ge((a==null?void 0:a.message)||"Gagal memuat data layanan dari server. Silakan coba beberapa saat lagi."),xe([])}finally{he(!1)}})()},[g]);const ke=i.useMemo(()=>W.flatMap(t=>t.services),[W]),b=i.useMemo(()=>{const t=Number(s.service);if(t)return ke.find(a=>Number(a.id)===t)},[s.service,ke]),H=(b==null?void 0:b.durationDays)||1;i.useEffect(()=>{let t=!0;return(async()=>{try{ue(!0),me(null);const a=await Ve();if(!t)return;const r=Array.isArray(a==null?void 0:a.fully_booked_dates)?a.fully_booked_dates:Array.isArray(a==null?void 0:a.fullyBookedDates)?a.fullyBookedDates:[],n=(a==null?void 0:a.booked_slots)??(a==null?void 0:a.bookedSlots)??{},d=(a==null?void 0:a.max_capacity_per_slot)??(a==null?void 0:a.maxCapacityPerSlot)??1,c=Number(d),o=Number.isFinite(c)&&c>0?c:1;let v={};if(Array.isArray(n))for(const p of n)typeof p=="string"&&(v[p]=(v[p]||0)+1);else if(n&&typeof n=="object")for(const[p,f]of Object.entries(n)){const S=typeof f=="number"?f:parseInt(String(f),10);v[p]=Number.isFinite(S)&&S>0?S:0}K(new Set(Array.isArray(r)?r:[])),B(v),U(o)}catch(a){if(console.error("Gagal load availability:",a),!t)return;me((a==null?void 0:a.message)||"Gagal memuat availability"),K(new Set),B({}),U(1)}finally{t&&ue(!1)}})(),()=>{t=!1}},[]);const Pe=i.useMemo(()=>He(9,17,12,13,30),[]),Ae=t=>{re("");const a=new Date(t);a.setDate(a.getDate()+H-1);for(let r=new Date(t);r<=a;r.setDate(r.getDate()+1))if(de.has(z(r))){re(`Rentang tanggal yang dipilih (${t.toLocaleDateString("id-ID")} - ${a.toLocaleDateString("id-ID")}) tidak tersedia karena salah satu hari telah penuh.`);return}x(r=>({...r,startDate:t,endDate:a,time:""}))},F=t=>{const{name:a,value:r}=t.target;j(n=>({...n,[a]:void 0})),x(n=>({...n,[a]:r}))},Me=()=>{if(M(!0),L(""),k(""),I(!0),j(t=>({...t,location:void 0})),!navigator.geolocation){L("Geolocation tidak didukung oleh browser ini."),M(!1),I(!1);return}navigator.geolocation.getCurrentPosition(t=>{const{latitude:a,longitude:r}=t.coords;P({lat:a,lng:r}),k("Lokasi GPS berhasil ditemukan."),M(!1),I(!1)},t=>{let a="Gagal mendapatkan lokasi. Pastikan izin lokasi diaktifkan.";t.code===t.PERMISSION_DENIED&&(a="Anda menolak izin lokasi. Mohon izinkan akses untuk melanjutkan."),L(a),M(!1),I(!1)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})},je=async()=>{const t=ne.trim();if(!t){k("Mohon masukkan alamat untuk dicari.");return}ie(!0),L(""),k(""),j(a=>({...a,location:void 0}));try{if(!ye){const o=await Ne(pe);if(V(o),!o)throw new Error("Google Maps JS belum siap. Cek adblock / restriction / network.")}const a=new window.google.maps.Geocoder,r=await new Promise((o,v)=>{a.geocode({address:t,region:"ID"},(p,f)=>{f==="OK"&&(p!=null&&p.length)?o(p[0]):v(new Error(`Geocoding gagal: ${f}`))})}),n=r.geometry.location,d=typeof n.lat=="function"?n.lat():n.lat,c=typeof n.lng=="function"?n.lng():n.lng;if(typeof d!="number"||typeof c!="number")throw new Error("Koordinat tidak valid dari Google Maps.");P({lat:d,lng:c}),k(`Lokasi berhasil ditemukan: ${r.formatted_address||t}`)}catch(a){console.error("Manual geocode error:",a);const r=String((a==null?void 0:a.message)||"");r.includes("REQUEST_DENIED")?k("REQUEST_DENIED: API key kemungkinan belum enable Geocoding API / Maps JavaScript API, billing belum aktif, atau domain belum di-allow di key restriction."):r.includes("ZERO_RESULTS")?k("Alamat tidak ditemukan (ZERO_RESULTS). Coba tulis lebih spesifik, misal: 'Monas, Jakarta Pusat'."):r.includes("OVER_QUERY_LIMIT")?k("Kuota geocoding habis (OVER_QUERY_LIMIT). Coba lagi nanti."):k((a==null?void 0:a.message)||"Terjadi kesalahan saat mencari alamat. Silakan coba lagi."),P(null)}finally{ie(!1)}},$=(t,a)=>{switch(t){case"name":if(!a.trim())return"Nama wajib diisi.";break;case"whatsapp":if(!a.trim())return"Nomor WhatsApp wajib diisi.";if(!/^(08|\+628)\d{8,12}$/.test(a))return"Format nomor WhatsApp tidak valid (contoh: 08123456789).";break;case"address":if(!a.trim())return"Alamat wajib diisi.";break}},Q=t=>{const{name:a,value:r}=t.target,n=$(a,r);j(d=>({...d,[a]:n}))},Y=()=>{const t={},a=$("name",s.name);a&&(t.name=a);const r=$("whatsapp",s.whatsapp);r&&(t.whatsapp=r);const n=$("address",s.address);return n&&(t.address=n),l||(t.location="Mohon tandai lokasi Anda."),j(t),Object.keys(t).length===0},Z=()=>{const t={};return s.service||(t.service="Pilih layanan."),j(t),Object.keys(t).length===0},J=()=>{const t={};return s.startDate||(t.startDate="Pilih tanggal."),s.time||(t.time="Pilih waktu."),j(t),Object.keys(t).length===0},Ie=()=>{let t=!1;m===1&&(t=Y()),m===2&&(t=Z()),m===3&&(t=J()),t&&u(a=>a+1)},Ge=()=>{j({}),u(t=>t-1)},Fe=async t=>{var r,n;if(t.preventDefault(),!Y()||!Z()||!J()){Y()?Z()?J()||u(3):u(2):u(1);return}if(!l||!s.startDate){E("Lokasi atau tanggal belum terisi. Silakan lengkapi data.","error");return}const a=Number(s.service);if(!a||Number.isNaN(a)){E("Layanan tidak valid. Silakan pilih ulang layanan.","error"),u(2);return}if(Ee){E("Sedang memuat slot jadwal. Coba lagi sebentar.","info");return}oe(!0);try{const d={fullname:s.name,whatsapp:s.whatsapp,service:a,address:s.address,lat:l.lat,lng:l.lng,schedule_date:We(s.startDate),schedule_time:s.time},c=await fetch("https://api-homeservice.viniela.id/api/v1/user/store-booking",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(d)});let o=null;try{o=await c.json()}catch{}if(!c.ok){const D=(o==null?void 0:o.message)||(o==null?void 0:o.error)||"";if(c.status===409&&String(D).includes("SLOT_FULL"))throw new Error("Slot jam itu sudah penuh. Silakan pilih jam lain.");if(c.status===409&&String(D).includes("DATE_NOT_AVAILABLE"))throw new Error("Tanggal yang dipilih tidak tersedia. Silakan pilih tanggal lain.");const w=D||`Gagal menyimpan booking di server (status ${c.status}).`;throw new Error(w)}const v=(b==null?void 0:b.name)||g||"",p={id:Date.now(),name:s.name,whatsapp:s.whatsapp,address:s.address,service:v||String(a),startDate:s.startDate.toISOString(),endDate:(s.endDate??s.startDate).toISOString(),time:s.time,status:"Confirmed",technician:"Belum Ditugaskan",lat:l.lat,lng:l.lng},f=`${z(s.startDate)}-${s.time}`,S=Number(((r=o==null?void 0:o.data)==null?void 0:r.used)??(o==null?void 0:o.used)??NaN),ee=Number(((n=o==null?void 0:o.data)==null?void 0:n.capacity)??(o==null?void 0:o.capacity)??NaN);Number.isFinite(ee)&&ee>0&&U(ee),B(D=>{const w={...D};return Number.isFinite(S)&&S>=0?w[f]=S:w[f]=(w[f]||0)+1,w}),H>1&&s.endDate&&K(D=>{const w=new Set(D);for(let T=new Date(s.startDate);T<=s.endDate;T.setDate(T.getDate()+1))w.add(z(T));return w});const Te=qe("order_created",p);E(Te,"success"),le(!0)}catch(d){console.error("Gagal menyimpan booking:",d),E(`Gagal menyimpan booking: ${(d==null?void 0:d.message)||"Terjadi kesalahan tidak diketahui."}`,"error")}finally{oe(!1)}},$e=()=>{le(!1),x({name:"",whatsapp:"",address:"",service:"",startDate:null,endDate:null,time:""}),P(null),L(""),j({}),u(1),y("/services")},X=i.useMemo(()=>{if(!s.startDate)return"";const t=s.startDate.toLocaleDateString("id-ID",{weekday:"long",day:"numeric",month:"long"});if(!s.endDate||s.startDate.getTime()===s.endDate.getTime())return t;const a=s.endDate.toLocaleDateString("id-ID",{weekday:"long",day:"numeric",month:"long"});return`${t} - ${a}`},[s.startDate,s.endDate]),we=(b==null?void 0:b.name)||g||"";return e.jsxs("section",{className:"py-24 bg-light-bg dark:bg-slate-900",children:[e.jsx("div",{className:"container mx-auto px-6",children:e.jsx("div",{className:"flex justify-center",children:e.jsxs("div",{className:"w-full max-w-4xl bg-white dark:bg-slate-800 p-6 md:p-8 rounded-2xl shadow-xl",children:[e.jsx("h2",{className:"text-2xl md:text-3xl font-bold font-poppins text-gray-800 dark:text-white mb-6 text-center",children:"Formulir Pemesanan Layanan"}),e.jsx(Xe,{currentStep:m}),q&&e.jsx("div",{className:"mb-4 text-center text-sm text-red-500",children:q}),ce&&e.jsx("div",{className:"mb-4 text-center text-sm text-red-500",children:ce}),e.jsxs("form",{onSubmit:Fe,noValidate:!0,children:[e.jsxs("div",{className:"min-h-[420px] py-4",children:[m===1&&e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Nama Lengkap"}),e.jsx("input",{type:"text",name:"name",id:"name",value:s.name,onChange:F,onBlur:Q,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm dark:bg-slate-700 dark:border-slate-600 focus:border-primary focus:ring-primary",required:!0}),h.name&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:h.name})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"whatsapp",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Nomor WhatsApp"}),e.jsx("input",{type:"tel",name:"whatsapp",id:"whatsapp",value:s.whatsapp,onChange:F,onBlur:Q,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm dark:bg-slate-700 dark:border-slate-600 focus:border-primary focus:ring-primary",placeholder:"08123456789",required:!0}),h.whatsapp&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:h.whatsapp})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"address",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Alamat Lengkap"}),e.jsx("textarea",{name:"address",id:"address",rows:3,value:s.address,onChange:F,onBlur:Q,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm dark:bg-slate-700 dark:border-slate-600 focus:border-primary focus:ring-primary",placeholder:"Contoh: Jl. Mawar No. 10, RT 01/RW 02, Kelurahan, Kecamatan, Kota.",required:!0}),h.address&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:h.address})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Penanda Lokasi (Wajib)"}),e.jsxs("div",{className:"p-4 border dark:border-slate-700 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-gray-800 dark:text-white",children:"Opsi 1: Gunakan Lokasi GPS"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-2",children:"Paling akurat jika Anda memesan dari lokasi pengerjaan."}),e.jsxs("button",{type:"button",onClick:Me,disabled:A||G,className:"inline-flex items-center justify-center gap-2 px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-slate-800 bg-slate-200 hover:bg-slate-300 dark:bg-slate-700 dark:text-slate-200 dark:hover:bg-slate-600 disabled:opacity-50",children:[A?e.jsxs("svg",{className:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):e.jsx(Qe,{size:16}),e.jsx("span",{children:A?"Mencari GPS...":"Gunakan Lokasi Saat Ini"})]}),ve&&e.jsxs("p",{className:"text-blue-600 dark:text-blue-400 text-xs mt-2 flex items-center gap-1.5",children:[e.jsx(Re,{size:14}),"Mohon izinkan akses lokasi pada prompt browser Anda."]}),_&&e.jsx("p",{className:"text-red-500 text-xs mt-2",children:_})]}),e.jsxs("div",{className:"flex items-center my-4",children:[e.jsx("div",{className:"flex-grow border-t border-gray-300 dark:border-gray-600"}),e.jsx("span",{className:"flex-shrink mx-4 text-gray-500 dark:text-gray-400 text-sm font-semibold",children:"ATAU"}),e.jsx("div",{className:"flex-grow border-t border-gray-300 dark:border-gray-600"})]}),e.jsxs("div",{className:"p-4 border dark:border-slate-700 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-gray-800 dark:text-white",children:"Opsi 2: Cari Alamat Manual"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-2",children:"Gunakan jika memesan untuk lokasi lain (misal: rumah orang tua)."}),!ye&&e.jsx("p",{className:"text-xs text-yellow-600 dark:text-yellow-400 mb-2",children:"Memuat Google Maps..."}),be&&e.jsx("p",{className:"text-xs text-red-500 mb-2",children:be}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("input",{type:"text",value:ne,onChange:t=>Se(t.target.value),onKeyDown:t=>{t.key==="Enter"&&(t.preventDefault(),je())},placeholder:"Contoh: Monas, Jakarta Pusat",className:"block w-full rounded-md border-gray-300 shadow-sm dark:bg-slate-700 dark:border-slate-600 focus:border-primary focus:ring-primary"}),e.jsxs("button",{type:"button",onClick:je,disabled:G||A,className:"inline-flex items-center justify-center gap-2 px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary hover:bg-primary-dark disabled:bg-gray-400",children:[G?e.jsxs("svg",{className:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):e.jsx(Ye,{size:16}),e.jsx("span",{children:G?"Mencari...":"Cari"})]})]}),O&&e.jsx("p",{className:`text-xs mt-2 ${l?"text-green-600 dark:text-green-400":"text-red-500"}`,children:O})]}),h.location&&!_&&!O&&e.jsx("p",{className:"text-red-500 text-xs mt-2",children:h.location}),l&&e.jsx("div",{className:"mt-4 rounded-lg overflow-hidden h-48 shadow-md border dark:border-slate-600",children:e.jsx("iframe",{title:"Location Preview",width:"100%",height:"100%",style:{border:0},loading:"lazy",allowFullScreen:!1,src:`https://maps.google.com/maps?q=${l.lat},${l.lng}&z=16&output=embed`},`${l.lat}-${l.lng}`)})]})]}),m===2&&e.jsx("div",{className:"space-y-6 animate-fade-in",children:e.jsxs("div",{children:[e.jsx("label",{htmlFor:"service",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Pilih Layanan"}),e.jsxs("select",{name:"service",id:"service",value:s.service,onChange:F,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm dark:bg-slate-700 dark:border-slate-600 focus:border-primary focus:ring-primary text-base p-3",required:!0,disabled:Ce||!!q,children:[e.jsx("option",{value:"",disabled:!0,children:"-- Pilih salah satu --"}),W.map(t=>e.jsx("optgroup",{label:t.category,children:t.services.map(a=>e.jsx("option",{value:String(a.id),children:a.name},a.id??a.name))},t.category))]}),h.service&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:h.service}),b&&e.jsxs("div",{className:"mt-4 p-3 bg-primary-light dark:bg-slate-700/50 rounded-lg text-sm text-primary-dark dark:text-teal-300",children:["Estimasi durasi pengerjaan:"," ",e.jsxs("strong",{children:[H," hari"]}),". Kalender akan otomatis memilih rentang tanggal yang dibutuhkan."]})]})}),m===3&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 animate-fade-in",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Pilih Tanggal Mulai"}),e.jsx(Be,{selectedDate:s.startDate,onDateSelect:Ae,fullyBookedDates:de}),h.startDate&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:h.startDate}),se&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:se})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Pilih Waktu Mulai"}),s.startDate?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-3 bg-primary-light dark:bg-slate-700/50 rounded-lg text-sm text-primary-dark dark:text-teal-300 mb-4",children:[e.jsx("p",{children:e.jsx("strong",{children:"Tanggal Terpilih:"})}),e.jsx("p",{children:X}),C>1&&e.jsxs("p",{className:"mt-1 opacity-80",children:["Kapasitas per jam:"," ",e.jsx("strong",{children:C})]})]}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:Pe.map(t=>{const a=`${z(s.startDate)}-${t}`,r=Le[a]||0,n=r>=C,d=Math.max(0,C-r);return e.jsxs("button",{type:"button",onClick:()=>x(c=>({...c,time:t})),disabled:n,title:n?"Slot penuh":`Sisa kapasitas: ${d}`,className:`p-2 rounded-md text-sm font-semibold border-2 transition-colors ${s.time===t?"bg-primary text-white border-primary":"bg-transparent border-gray-300 dark:border-slate-600"} ${n?"bg-gray-200 dark:bg-slate-600 text-gray-400 dark:text-gray-500 line-through cursor-not-allowed":"hover:border-primary"}`,children:[t,!n&&C>1?e.jsxs("span",{className:"ml-2 text-xs opacity-80",children:["(",d," sisa)"]}):null]},t)})})]}):e.jsx("div",{className:"text-center p-8 bg-gray-50 dark:bg-slate-700/50 rounded-lg h-full flex items-center justify-center",children:e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Pilih tanggal untuk melihat slot waktu."})}),h.time&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:h.time})]})]}),m===4&&e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-white",children:"Konfirmasi Pesanan Anda"}),e.jsxs("div",{className:"bg-light-bg dark:bg-slate-700/50 p-4 rounded-lg space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Info Kontak"}),e.jsx("p",{className:"font-semibold text-gray-800 dark:text-white",children:s.name}),e.jsx("p",{className:"text-gray-600 dark:text-slate-300",children:s.whatsapp}),e.jsx("p",{className:"text-gray-600 dark:text-slate-300 max-w-xs",children:s.address})]}),e.jsxs("button",{type:"button",onClick:()=>u(1),className:"text-primary hover:underline text-sm font-semibold flex items-center gap-1",children:[e.jsx(ae,{size:12})," Ubah"]})]}),e.jsxs("div",{className:"flex justify-between items-center border-t border-gray-200 dark:border-slate-600 pt-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Layanan"}),e.jsx("p",{className:"font-semibold text-gray-800 dark:text-white",children:we||"-"})]}),e.jsxs("button",{type:"button",onClick:()=>u(2),className:"text-primary hover:underline text-sm font-semibold flex items-center gap-1",children:[e.jsx(ae,{size:12})," Ubah"]})]}),e.jsxs("div",{className:"flex justify-between items-center border-t border-gray-200 dark:border-slate-600 pt-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Jadwal"}),e.jsxs("p",{className:"font-semibold text-gray-800 dark:text-white",children:[X," - ",s.time]})]}),e.jsxs("button",{type:"button",onClick:()=>u(3),className:"text-primary hover:underline text-sm font-semibold flex items-center gap-1",children:[e.jsx(ae,{size:12})," Ubah"]})]})]}),l&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Pratinjau Lokasi"}),e.jsx("div",{className:"rounded-lg overflow-hidden h-32 shadow-md border dark:border-slate-600",children:e.jsx("iframe",{title:"Location Preview",width:"100%",height:"100%",style:{border:0},loading:"lazy",allowFullScreen:!1,src:`https://maps.google.com/maps?q=${l.lat},${l.lng}&z=16&output=embed`})})]})]})]}),e.jsxs("div",{className:"mt-8 pt-6 border-t dark:border-slate-700 flex justify-between items-center",children:[m>1?e.jsx("button",{type:"button",onClick:Ge,className:"bg-gray-200 text-gray-800 dark:bg-slate-600 dark:text-gray-200 font-bold px-6 py-3 rounded-lg hover:bg-gray-300 dark:hover:bg-slate-500 transition-colors",children:"Kembali"}):e.jsx("div",{}),m<4&&e.jsx("button",{type:"button",onClick:Ie,className:"bg-primary text-white font-bold px-6 py-3 rounded-lg hover:bg-primary-dark transition-colors",children:"Lanjut"}),m===4&&e.jsxs("button",{type:"submit",disabled:R,className:"w-full sm:w-auto bg-primary text-white font-bold px-8 py-3 rounded-lg hover:bg-primary-dark transition-all duration-300 disabled:bg-gray-400 flex items-center justify-center",children:[R&&e.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),R?"Mengirim...":"Kirim Pesanan"]})]})]})]})})}),e.jsx(Ze,{isOpen:De,onClose:$e,bookingDetails:{name:s.name,service:we||"-",schedule:`${X} pukul ${s.time}`}})]})},ia=()=>e.jsxs(e.Fragment,{children:[e.jsx(Je,{}),e.jsx(ea,{})]});export{ia as default};
