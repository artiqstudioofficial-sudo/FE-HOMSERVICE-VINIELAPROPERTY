import{W as K,P as i,j as e,b as G,g as V,M as q}from"./index-DS1OnVdj.js";import{y as Y,f as Q,u as X,g as Z,p as ee}from"./GenericConfirmationModal-CdOsDkWD-cHfr4bbn-D1qeKaas.js";import{m as te,o as H}from"./notifications-DpjyIQbu-DSd2Ew0m-CgX_mb7J.js";import{v as ae,A as se,_ as re}from"./storage-EbjkSq6s-1mYEmn5g-BfRZMB_M.js";import{e as le}from"./clock-BvZjhqCS-CTPmfAM--CCa9bIp0.js";/**
 * @license lucide-react v0.417.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E=G("CalendarCheck",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m9 16 2 2 4-4",key:"19s6y9"}]]),J={Confirmed:1,"On Site":2,"In Progress":3,Completed:4,Cancelled:5};async function ne(t,N,j){var p,x;const k=J[N]??J.Confirmed,c=await fetch(`${((x=(p=import.meta)==null?void 0:p.env)==null?void 0:x.VITE_API_BASE_URL)||"https://api-homeservice.viniela.id"}/api/v1/admin/update-booking-status`,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({form_id:t,user_id:j,status:k})}),o=await c.json().catch(()=>null);if(!c.ok){const l=(o==null?void 0:o.message)||(o==null?void 0:o.error)||`Gagal update status (status ${c.status})`;throw new Error(l)}}const O=({label:t,photoUrlOrPath:N,onUploadFile:j,disabled:p=!1})=>{const[x,k]=i.useState(!1),c=i.useMemo(()=>se(N),[N]),o=async l=>{var D;const b=(D=l.target.files)==null?void 0:D[0];if(b)try{k(!0),await j(b)}catch(w){console.error(w),alert((w==null?void 0:w.message)||"Gagal upload foto.")}finally{k(!1),l.currentTarget.value=""}};return e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:t}),e.jsxs("div",{className:"mt-1 flex items-center space-x-4",children:[e.jsx("div",{className:"w-20 h-20 rounded-lg bg-gray-100 dark:bg-slate-700 flex items-center justify-center overflow-hidden",children:x?e.jsxs("svg",{className:"animate-spin h-5 w-5 text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):c?e.jsx("img",{src:c,alt:"Preview",className:"w-full h-full object-cover"}):e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14"})})}),e.jsxs("label",{htmlFor:`file-upload-${t.replace(/\s+/g,"-")}`,className:`relative cursor-pointer bg-white dark:bg-slate-600 py-2 px-3 border border-gray-300 dark:border-slate-500 rounded-md shadow-sm text-sm leading-4 font-medium text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-slate-500 ${p?"opacity-50 cursor-not-allowed":""}`,children:[e.jsx("span",{children:c?"Ganti Foto":"Unggah Foto"}),e.jsx("input",{id:`file-upload-${t.replace(/\s+/g,"-")}`,name:"file-upload",type:"file",className:"sr-only",onChange:o,accept:"image/*",disabled:p})]})]})]})},R=({booking:t,currentTechnicianId:N,onBookingUpdateLocal:j,onRefresh:p})=>{var x,k;const c=new Date;c.setHours(0,0,0,0);const o=new Date(t.startDate);o.setHours(0,0,0,0);const l=new Date(t.endDate);l.setHours(0,0,0,0);const D=o.getTime()!==l.getTime(),b=c>=o&&c<=l,w=c.getTime()===o.getTime(),_=c.getTime()===l.getTime(),[z,T]=i.useState(!1),[I,$]=i.useState(t.note||""),[v,u]=i.useState(t.additionalCosts||0),[M,C]=i.useState(()=>(t.additionalCosts||0).toString()==="0"?"0":new Intl.NumberFormat("id-ID").format(t.additionalCosts||0)),[F,A]=i.useState(!1),{addNotification:L}=q(),r=s=>{const d=s.target.value;if(d===""){u(0),C("");return}const n=parseInt(d.replace(/\./g,""),10);isNaN(n)||(u(n),C(new Intl.NumberFormat("id-ID").format(n)))},g=()=>{M===""&&C("0")},a=async(s,d)=>{const n=t.formId??t.form_id??null;if(!n)throw new Error("form_id tidak ditemukan pada booking (cek mapping API).");await ne(Number(n),s,N);const y={...t,...d,status:s};j(y),await p()},f=async s=>{const d=new Date().toISOString();try{if(s==="On Site"){const n=H("technician_on_the_way",{...t,status:s,arrivalTime:d});L(n,"info"),await a(s,{arrivalTime:d});return}if(s==="In Progress"){await a(s,{startTime:d});return}await a(s)}catch(n){console.error(n),L((n==null?void 0:n.message)||"Gagal update status di server.","error")}},h=async(s,d)=>{const n=t.formId??t.form_id??null;if(!n)throw new Error("form_id tidak ditemukan pada booking (cek mapping API).");const y=await re(Number(n),s,d),P=y==null?void 0:y.url,U={...t,photos:{...t.photos||{},[s]:P}};j(U),await p()},m=()=>{var s;if(!((s=t.photos)!=null&&s.after)){alert("Harap unggah foto setelah pengerjaan selesai.");return}A(!0)},S=async()=>{try{const s=new Date,d=t.startTime||new Date().toISOString(),n=new Date(d),y=Math.round((s.getTime()-n.getTime())/6e4);await a("Completed",{endTime:s.toISOString(),workDurationMinutes:y>0?y:0,note:I,additionalCosts:v});const P=H("job_completed",{...t,status:"Completed"});L(P,"success"),T(!1),A(!1)}catch(s){console.error(s),L((s==null?void 0:s.message)||"Gagal menyelesaikan pekerjaan.","error")}},B=()=>{var s,d,n,y,P;if(!b&&t.status!=="Completed"&&t.status!=="Cancelled")return e.jsx("div",{className:"mt-4 pt-4 border-t dark:border-slate-700 text-center",children:e.jsx("p",{className:"font-semibold text-gray-500 dark:text-gray-400",children:"Tugas belum dimulai."})});switch(t.status){case"Confirmed":return w?e.jsx("div",{className:"mt-4 pt-4 border-t dark:border-slate-700",children:e.jsx("button",{onClick:()=>f("On Site"),className:"w-full bg-blue-500 text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-600 transition-colors",children:"Saya Sudah di Lokasi"})}):e.jsx("div",{className:"mt-4 pt-4 border-t dark:border-slate-700 text-center",children:e.jsxs("p",{className:"font-semibold text-gray-500 dark:text-gray-400",children:["Tugas dimulai pada ",o.toLocaleDateString("id-ID")]})});case"On Site":return w?e.jsxs("div",{className:"mt-4 pt-4 border-t dark:border-slate-700 space-y-4",children:[t.arrivalTime&&e.jsxs("p",{className:"text-sm text-center font-semibold text-blue-600 dark:text-blue-400",children:["Tiba pada: ",new Date(t.arrivalTime).toLocaleTimeString("id-ID")]}),e.jsx(O,{label:"Foto Tiba di Lokasi",photoUrlOrPath:(s=t.photos)==null?void 0:s.arrival,onUploadFile:U=>h("arrival",U)}),((d=t.photos)==null?void 0:d.arrival)&&e.jsx(O,{label:"Foto Sebelum Pengerjaan",photoUrlOrPath:(n=t.photos)==null?void 0:n.before,onUploadFile:U=>h("before",U)}),e.jsx("button",{onClick:()=>f("In Progress"),disabled:!((y=t.photos)!=null&&y.arrival)||!((P=t.photos)!=null&&P.before),className:"w-full bg-yellow-500 text-white font-bold py-2 px-4 rounded-lg hover:bg-yellow-600 transition-colors disabled:bg-gray-400",children:"Mulai Pekerjaan"})]}):e.jsx("div",{className:"mt-4 pt-4 border-t dark:border-slate-700 text-center",children:e.jsx("p",{className:"font-semibold text-gray-500 dark:text-gray-400",children:"Menunggu hari pertama dimulai."})});case"In Progress":return e.jsxs("div",{className:"mt-4 pt-4 border-t dark:border-slate-700 space-y-4",children:[t.startTime&&e.jsxs("p",{className:"text-sm text-center font-semibold text-yellow-600 dark:text-yellow-400",children:["Mulai pada: ",new Date(t.startTime).toLocaleTimeString("id-ID")]}),_?e.jsx("button",{onClick:()=>T(!0),className:"w-full bg-green-500 text-white font-bold py-2 px-4 rounded-lg hover:bg-green-600 transition-colors",children:"Selesaikan Pekerjaan"}):e.jsx("p",{className:"font-semibold text-yellow-600 dark:text-yellow-400 text-center",children:"Pekerjaan Sedang Berlangsung"})]});case"Completed":return e.jsx("div",{className:"mt-4 pt-4 border-t dark:border-slate-700 text-center",children:e.jsx("p",{className:"font-semibold text-green-600 dark:text-green-400",children:"Pekerjaan Selesai"})});case"Cancelled":return e.jsx("div",{className:"mt-4 pt-4 border-t dark:border-slate-700 text-center",children:e.jsx("p",{className:"font-semibold text-red-600 dark:text-red-400",children:"Dibatalkan"})});default:return null}},W=()=>{const s=o.toLocaleDateString("id-ID",{weekday:"long",day:"numeric",month:"long"});if(!D)return`${s} - ${t.time}`;const d=l.toLocaleDateString("id-ID",{weekday:"long",day:"numeric",month:"long"});return`${s} s/d ${d}`};return e.jsxs("div",{className:`bg-white dark:bg-slate-800 shadow-lg rounded-xl overflow-hidden border-l-4 ${b?"border-primary":"border-transparent"}`,"data-aos":"fade-up",children:[e.jsxs("div",{className:"p-5",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:t.service}),e.jsx("p",{className:"font-bold text-lg text-gray-800 dark:text-white",children:t.name})]}),b&&e.jsx("span",{className:"text-xs font-bold bg-primary text-white px-2 py-1 rounded-full",children:"AKTIF HARI INI"})]}),e.jsxs("div",{className:"mt-4 space-y-2 text-sm text-secondary dark:text-slate-300",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Jadwal:"})," ",W()]}),e.jsxs("div",{children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Alamat:"})," ",t.address]}),e.jsxs("a",{href:`https://www.google.com/maps/dir/?api=1&destination=${t.lat},${t.lng}`,target:"_blank",rel:"noopener noreferrer",className:"mt-2 inline-flex items-center gap-2 bg-blue-100 text-blue-800 dark:bg-blue-900/50 dark:text-blue-300 font-semibold text-xs px-3 py-1.5 rounded-full hover:bg-blue-200 dark:hover:bg-blue-800 transition-colors",children:[e.jsx(te,{size:14}),"Dapatkan Arah"]})]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Telepon:"})," ",t.whatsapp]}),(t.arrivalTime||t.startTime||t.endTime)&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200 dark:border-slate-700/50",children:[e.jsx("h4",{className:"font-semibold text-gray-700 dark:text-gray-200 mb-1",children:"Log Waktu Pengerjaan"}),t.arrivalTime&&e.jsxs("p",{children:[e.jsx("strong",{children:"Tiba di Lokasi:"})," ",new Date(t.arrivalTime).toLocaleString("id-ID",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"})]}),t.startTime&&e.jsxs("p",{children:[e.jsx("strong",{children:"Mulai Kerja:"})," ",new Date(t.startTime).toLocaleString("id-ID",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"})]}),t.endTime&&e.jsxs("p",{children:[e.jsx("strong",{children:"Selesai Kerja:"})," ",new Date(t.endTime).toLocaleString("id-ID",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"})]}),t.workDurationMinutes!=null&&e.jsxs("p",{children:[e.jsx("strong",{children:"Total Durasi Kerja:"})," ",t.workDurationMinutes," menit"]})]})]}),z?e.jsxs("div",{className:"mt-4 pt-4 border-t dark:border-slate-700 space-y-4",children:[e.jsx("h4",{className:"font-bold text-center",children:"Formulir Penyelesaian"}),e.jsx(O,{label:"Foto Setelah Selesai",photoUrlOrPath:(x=t.photos)==null?void 0:x.after,onUploadFile:s=>h("after",s)}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:`notes-${t.id}`,className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Catatan Pekerjaan Tambahan"}),e.jsx("textarea",{id:`notes-${t.id}`,rows:3,value:I,onChange:s=>$(s.target.value),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm dark:bg-slate-700 dark:border-slate-600 focus:border-primary focus:ring-primary sm:text-sm",placeholder:"Catatan tambahan..."})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:`costs-${t.id}`,className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Biaya Tambahan (Bahan, dll.)"}),e.jsxs("div",{className:"relative mt-1 rounded-md shadow-sm",children:[e.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",children:e.jsx("span",{className:"text-gray-500 sm:text-sm",children:"Rp"})}),e.jsx("input",{type:"text",inputMode:"numeric",id:`costs-${t.id}`,value:M,onChange:r,onBlur:g,className:"block w-full rounded-md border-gray-300 pl-8 pr-2 dark:bg-slate-700 dark:border-slate-600 focus:border-primary focus:ring-primary sm:text-sm",placeholder:"0"})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsx("button",{onClick:()=>T(!1),className:"w-full bg-gray-300 text-gray-800 font-bold py-2 px-4 rounded-lg hover:bg-gray-400 transition-colors",children:"Batal"}),e.jsx("button",{onClick:m,disabled:!((k=t.photos)!=null&&k.after),className:"w-full bg-primary text-white font-bold py-2 px-4 rounded-lg hover:bg-primary-dark transition-colors disabled:bg-gray-400",children:"Konfirmasi Selesai"})]})]}):B()]}),e.jsx(ee,{isOpen:F,onClose:()=>A(!1),onConfirm:S,title:"Konfirmasi Penyelesaian",confirmText:"Ya, Selesaikan",confirmButtonClass:"bg-green-600 hover:bg-green-700 focus:ring-green-500",children:e.jsx("p",{children:"Apakah Anda yakin ingin menyelesaikan pekerjaan ini? Pastikan data dan foto sudah benar."})})]})},ge=()=>{const{currentUser:t,logout:N}=K(),[j,p]=i.useState([]),[x,k]=i.useState("dashboard"),[c,o]=i.useState(!1),[l,D]=i.useState(null),[b,w]=i.useState("upcoming"),[_,z]=i.useState(!1),T=async()=>{z(!0);try{const r=await ae();p(r)}catch(r){console.error(r)}finally{z(!1)}};i.useEffect(()=>{const r=()=>T();return window.addEventListener("focus",r),r(),()=>window.removeEventListener("focus",r)},[]);const I=i.useMemo(()=>t?j.filter(r=>r.technician===t.name).sort((r,g)=>new Date(r.startDate).getTime()-new Date(g.startDate).getTime()):[],[t,j]),{completedJobs:$,upcomingJobsCategorized:v,upcomingJobsFlat:u}=i.useMemo(()=>{const r=I.filter(m=>m.status!=="Completed"&&m.status!=="Cancelled"),g=I.filter(m=>m.status==="Completed"||m.status==="Cancelled"),a=new Date;a.setHours(0,0,0,0);const f=new Date(a);f.setDate(a.getDate()+1);const h={today:[],tomorrow:[],upcoming:[]};return r.forEach(m=>{const S=new Date(m.startDate);S.setHours(0,0,0,0);const B=new Date(m.endDate);B.setHours(0,0,0,0),S.getTime()===a.getTime()||a>S&&a<=B?h.today.push(m):S.getTime()===f.getTime()?h.tomorrow.push(m):S.getTime()>f.getTime()&&h.upcoming.push(m)}),{completedJobs:g,upcomingJobsCategorized:h,upcomingJobsFlat:r}},[I]);i.useEffect(()=>{x==="map"&&u.length>0&&!l&&D({lat:u[0].lat,lng:u[0].lng,title:u[0].name})},[x,u,l]);const M=r=>{p(g=>g.map(a=>a.id===r.id?r:a))},C=i.useMemo(()=>{const r=new Date,g=new Date(r);g.setDate(r.getDate()-r.getDay()),g.setHours(0,0,0,0);const a=new Date(g);a.setDate(g.getDate()+6),a.setHours(23,59,59,999);const f=u.filter(h=>{const m=new Date(h.startDate);return m>=g&&m<=a});return{today:v.today.length,thisWeek:f.length,completed:$.length}},[v.today,u,$]);if(!t)return e.jsx("div",{className:"text-center py-20",children:"Loading..."});const F=t==null?void 0:t.id;if(!F)return e.jsx("div",{className:"text-center py-20",children:"currentUser.id tidak ada. Pastikan endpoint auth/me mengembalikan id user."});const A={dashboard:"Dashboard",jobs:"Tugas Saya",map:"Peta Tugas"},L=()=>{switch(x){case"dashboard":return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-white dark:bg-slate-800 p-6 rounded-2xl shadow-lg flex items-center gap-4",children:[e.jsx("div",{className:"bg-primary-light p-3 rounded-full",children:e.jsx(E,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Tugas Hari Ini"}),e.jsx("p",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:C.today})]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 p-6 rounded-2xl shadow-lg flex items-center gap-4",children:[e.jsx("div",{className:"bg-primary-light p-3 rounded-full",children:e.jsx(le,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Tugas Minggu Ini"}),e.jsx("p",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:C.thisWeek})]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 p-6 rounded-2xl shadow-lg flex items-center gap-4",children:[e.jsx("div",{className:"bg-primary-light p-3 rounded-full",children:e.jsx(V,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Total Tugas Selesai"}),e.jsx("p",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:C.completed})]})]})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold font-poppins text-gray-800 dark:text-white mb-4",children:"Jadwal Hari Ini"}),_?e.jsx("div",{className:"text-center py-10 bg-white dark:bg-slate-800 rounded-xl shadow-md",children:e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Memuat data..."})}):v.today.length>0?e.jsx("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-lg divide-y dark:divide-slate-700",children:v.today.map(a=>e.jsxs("div",{className:"p-4 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-800 dark:text-white",children:a.name}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:a.service})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-bold text-primary",children:a.time}),e.jsx("p",{className:"text-xs text-gray-400",children:a.status})]})]},a.id))}):e.jsx("div",{className:"text-center py-10 bg-white dark:bg-slate-800 rounded-xl shadow-md",children:e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Tidak ada jadwal untuk hari ini."})})]})]},"dashboard");case"jobs":const r={"Hari Ini":v.today,Besok:v.tomorrow,"Akan Datang":v.upcoming},g=Object.values(r).every(a=>a.length===0);return e.jsxs("div",{children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"inline-flex rounded-md shadow-sm bg-white dark:bg-slate-800 p-1",children:[e.jsx("button",{onClick:()=>w("upcoming"),className:`px-4 py-2 text-sm font-medium rounded-md transition-colors ${b==="upcoming"?"bg-primary text-white":"text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-slate-700"}`,children:"Akan Datang"}),e.jsx("button",{onClick:()=>w("completed"),className:`px-4 py-2 text-sm font-medium rounded-md transition-colors ${b==="completed"?"bg-primary text-white":"text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-slate-700"}`,children:"Riwayat"})]}),e.jsx("button",{onClick:T,className:"ml-3 px-4 py-2 text-sm font-semibold rounded-md bg-white dark:bg-slate-800 border border-gray-200 dark:border-slate-700 hover:bg-gray-50 dark:hover:bg-slate-700",children:"Refresh"})]}),b==="upcoming"&&(g?e.jsx("div",{className:"text-center py-20 bg-white dark:bg-slate-800 rounded-xl shadow-md","data-aos":"zoom-in",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Tidak Ada Tugas Akan Datang"})}):e.jsx("div",{className:"space-y-10",children:Object.entries(r).map(([a,f])=>f.length>0&&e.jsxs("div",{"data-aos":"fade-up",children:[e.jsx("h3",{className:"text-xl font-bold font-poppins text-gray-800 dark:text-white mb-4",children:a}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:f.map(h=>e.jsx(R,{booking:h,currentTechnicianId:F,onBookingUpdateLocal:M,onRefresh:T},h.id))})]},a))})),b==="completed"&&($.length>0?e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:$.map(a=>e.jsx(R,{booking:a,currentTechnicianId:F,onBookingUpdateLocal:M,onRefresh:T},a.id))}):e.jsx("div",{className:"text-center py-20 bg-white dark:bg-slate-800 rounded-xl shadow-md","data-aos":"zoom-in",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Belum Ada Riwayat Tugas"})}))]},"jobs");case"map":return e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 h-[600px]","data-aos":"fade-up",children:[e.jsx("div",{className:"lg:col-span-1 bg-white dark:bg-slate-800 shadow-xl rounded-2xl p-4 space-y-3 h-full overflow-y-auto",children:u.length>0?u.map(a=>e.jsx("div",{className:`w-full p-4 rounded-lg transition-all duration-200 border-l-4 ${(l==null?void 0:l.title)===a.name?"bg-primary-light dark:bg-slate-700 border-primary":"bg-transparent"}`,children:e.jsxs("button",{onClick:()=>D({lat:a.lat,lng:a.lng,title:a.name}),className:"w-full text-left",children:[e.jsx("p",{className:"font-bold text-gray-800 dark:text-white",children:a.name}),e.jsxs("div",{className:"text-sm font-semibold text-primary mt-1",children:[new Date(a.startDate).toLocaleDateString("id-ID",{day:"numeric",month:"long"})," ","- ",a.time]})]})},a.id)):e.jsx("div",{className:"text-center py-10 text-gray-500 dark:text-gray-400",children:e.jsx("p",{children:"Tidak ada pekerjaan akan datang."})})}),e.jsx("div",{className:"lg:col-span-2 bg-white dark:bg-slate-800 shadow-xl rounded-2xl overflow-hidden h-full flex flex-col",children:l?e.jsx("iframe",{title:"Job Location Map",className:"w-full h-full border-0",src:`https://maps.google.com/maps?q=${l.lat},${l.lng}&t=&z=15&ie=UTF8&iwloc=&output=embed`,allowFullScreen:!1,loading:"lazy"},`${l.lat}-${l.lng}`):e.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-center text-center text-gray-500 dark:text-gray-400 p-6",children:[e.jsx(Z,{size:48,className:"mb-4 text-gray-300 dark:text-gray-600"}),e.jsx("h3",{className:"font-bold text-xl",children:"Peta Lokasi Tugas"}),e.jsx("p",{children:"Tidak ada tugas akan datang untuk ditampilkan."})]})})]},"map");default:return null}};return e.jsxs("div",{className:"bg-light-bg dark:bg-slate-900 min-h-screen",children:[e.jsxs("div",{className:"flex",children:[e.jsxs("aside",{className:`fixed lg:relative lg:translate-x-0 inset-y-0 left-0 z-50 w-64 bg-white dark:bg-slate-800 shadow-lg transition-transform duration-300 ease-in-out ${c?"translate-x-0":"-translate-x-full"}`,children:[e.jsx("div",{className:"flex items-center justify-center p-6 border-b dark:border-slate-700 h-20",children:e.jsx("span",{className:"text-2xl font-bold text-gray-800 dark:text-gray-100 font-poppins",children:"Teknisi"})}),e.jsx("nav",{className:"flex-grow p-4 space-y-2",children:[{name:"Dashboard",icon:Y,section:"dashboard"},{name:"Tugas Saya",icon:E,section:"jobs"},{name:"Peta Tugas",icon:Q,section:"map"}].map(r=>e.jsxs("button",{onClick:()=>{k(r.section),o(!1)},className:`w-full flex items-center gap-3 px-4 py-3 rounded-lg text-base font-semibold transition-colors ${x===r.section?"bg-primary-light text-primary dark:bg-slate-700":"text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-slate-700/50"}`,children:[e.jsx(r.icon,{size:20}),r.name]},r.section))}),e.jsx("div",{className:"p-4 border-t dark:border-slate-700",children:e.jsxs("button",{onClick:N,className:"w-full flex items-center gap-3 px-4 py-3 rounded-lg text-base font-semibold text-red-500 hover:bg-red-50 dark:hover:bg-red-900/50",children:[e.jsx(X,{size:20}),"Logout"]})})]}),e.jsxs("div",{className:"flex-1 w-full lg:w-auto",children:[e.jsxs("header",{className:"sticky top-0 z-40 bg-white/80 dark:bg-slate-900/80 backdrop-blur-sm shadow-sm h-20 flex items-center justify-between lg:justify-end px-6",children:[e.jsx("button",{onClick:()=>o(!0),className:"lg:hidden p-2 text-gray-600 dark:text-gray-300",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 12h16M4 18h16"})})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"font-semibold text-gray-700 dark:text-gray-200",children:["Hello, ",t==null?void 0:t.name]}),e.jsx("div",{className:"w-10 h-10 rounded-full bg-primary-light dark:bg-slate-700 flex items-center justify-center text-primary font-bold text-lg",children:t==null?void 0:t.name.charAt(0)})]})]}),e.jsxs("main",{className:"p-6",children:[e.jsx("h1",{className:"text-3xl font-bold font-poppins text-gray-800 dark:text-white mb-6",children:A[x]}),L()]})]})]}),c&&e.jsx("div",{onClick:()=>o(!1),className:"fixed inset-0 bg-black/50 z-40 lg:hidden"})]})};export{ge as default};
